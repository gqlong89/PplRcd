//============================================================================//
//            G L O B A L   D E F I N I T I O N S                             //
//============================================================================//
#include "stm32f10x.h"
#include "stm32f10x_pwr.h"
#include "power.h"
#include "system.h"
#include "sdhDef.h"
//------------------------------------------------------------------------------
// const defines
//------------------------------------------------------------------------------

//------------------------------------------------------------------------------
// module global vars
//------------------------------------------------------------------------------


//------------------------------------------------------------------------------
// global function prototypes
//------------------------------------------------------------------------------

//============================================================================//
//            P R I V A T E   D E F I N I T I O N S                           //
//============================================================================//

//------------------------------------------------------------------------------
// const defines
//------------------------------------------------------------------------------

//------------------------------------------------------------------------------
// local types
//------------------------------------------------------------------------------

//------------------------------------------------------------------------------
// local vars
//------------------------------------------------------------------------------


//------------------------------------------------------------------------------
// local function prototypes
//------------------------------------------------------------------------------



//============================================================================//
//            P U B L I C   F U N C T I O N S                                 //
//============================================================================//
int PVD_Init(void)
{
	EXTI_InitTypeDef exti_param;
	
	PWR_PVDLevelConfig(PWR_PVDLevel_2V8); 
	PWR_PVDCmd(ENABLE); 
	
	EXTI_StructInit(&exti_param);
	exti_param.EXTI_Line = EXTI_Line1; // PVD through EXTI Line detection Interrupt
	exti_param.EXTI_Mode = EXTI_Mode_Interrupt; //??????
	exti_param.EXTI_Trigger = EXTI_Trigger_Rising; //电压从高下降到低于设定阀值时产生中断
	exti_param.EXTI_LineCmd = ENABLE; // ?????
	EXTI_Init(&exti_param); // ??
	
	return RET_OK;
	
}



void PVD_IRQHandler(void)
{
	EXTI_ClearITPendingBit(EXTI_Line1);
	System_power_off();
	
}
//=========================================================================//
//                                                                         //
//          P R I V A T E   D E F I N I T I O N S                          //
//                                                                         //
//=========================================================================//
/// \name Private Functions
/// \{
